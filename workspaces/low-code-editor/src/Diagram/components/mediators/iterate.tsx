/**
 * Copyright (c) 2023, WSO2 LLC. (http://www.wso2.org) All Rights Reserved.
 *
 * WSO2 Inc. licenses this file to you under the Apache License,
 * Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations
 * under the License.
 *
 */

import React from "react";
import { Circle } from "@wso2-ei/low-code-diagram";
import { getComponent } from "../../util";
import { WorkerLine } from "../worker-line";

interface SquareProps {
  model: Circle;
}

export function Iterate(props: SquareProps) {
  const { model } = props;

  const viewState = model.viewState;
  const components: JSX.Element[] = [];

  model.children.forEach((child) => {
    components.push(getComponent(child.type, { model: child }));
  });

  return (
    <>
      <svg
        x={viewState.bBox.x}
        y={viewState.bBox.y}
        width={viewState.bBox.w}
        height={viewState.bBox.h}
        viewBox="0 0 800 600"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <rect width="800" height="600" fill="#C0C0C0" />
        <path d="M10 9H430V589H10V9Z" fill="#AD7B41" />
        <rect x="480" y="10" width="310" height="580" fill="#A9A9A9" />
        <path d="M468 299.5L439.5 335.44V263.56L468 299.5Z" fill="#71797E" />
        <path
          d="M166.679 499.909V529H160.528V499.909H166.679ZM183.231 507.182V511.727H170.092V507.182H183.231ZM173.075 501.955H179.126V522.295C179.126 522.854 179.211 523.29 179.381 523.602C179.552 523.905 179.789 524.118 180.092 524.241C180.404 524.365 180.764 524.426 181.171 524.426C181.455 524.426 181.739 524.402 182.023 524.355C182.308 524.298 182.525 524.256 182.677 524.227L183.629 528.73C183.326 528.825 182.899 528.934 182.35 529.057C181.801 529.189 181.133 529.27 180.347 529.298C178.889 529.355 177.611 529.161 176.512 528.716C175.423 528.271 174.576 527.58 173.969 526.642C173.363 525.705 173.065 524.521 173.075 523.091V501.955ZM196.881 529.426C194.637 529.426 192.705 528.972 191.086 528.062C189.476 527.144 188.236 525.847 187.364 524.17C186.493 522.485 186.058 520.491 186.058 518.19C186.058 515.946 186.493 513.976 187.364 512.281C188.236 510.586 189.462 509.265 191.043 508.318C192.634 507.371 194.5 506.898 196.64 506.898C198.079 506.898 199.419 507.13 200.66 507.594C201.91 508.048 202.999 508.735 203.927 509.653C204.864 510.572 205.594 511.727 206.114 513.119C206.635 514.502 206.896 516.121 206.896 517.977V519.639H188.472V515.889H201.2C201.2 515.018 201.01 514.246 200.631 513.574C200.253 512.902 199.727 512.376 199.055 511.997C198.392 511.609 197.62 511.415 196.739 511.415C195.821 511.415 195.006 511.628 194.296 512.054C193.595 512.471 193.046 513.034 192.648 513.744C192.251 514.445 192.047 515.226 192.038 516.088V519.653C192.038 520.733 192.237 521.666 192.634 522.452C193.041 523.238 193.614 523.844 194.353 524.27C195.092 524.696 195.968 524.909 196.981 524.909C197.653 524.909 198.269 524.814 198.827 524.625C199.386 524.436 199.864 524.152 200.262 523.773C200.66 523.394 200.963 522.93 201.171 522.381L206.768 522.75C206.484 524.095 205.901 525.269 205.021 526.273C204.149 527.267 203.022 528.044 201.64 528.602C200.267 529.152 198.681 529.426 196.881 529.426ZM210.844 529V507.182H216.711V510.989H216.938C217.336 509.634 218.004 508.612 218.941 507.92C219.879 507.22 220.958 506.869 222.18 506.869C222.483 506.869 222.809 506.888 223.16 506.926C223.51 506.964 223.818 507.016 224.083 507.082V512.452C223.799 512.366 223.406 512.291 222.904 512.224C222.402 512.158 221.943 512.125 221.526 512.125C220.636 512.125 219.841 512.319 219.14 512.707C218.449 513.086 217.899 513.616 217.492 514.298C217.094 514.98 216.896 515.766 216.896 516.656V529H210.844ZM232.808 529.412C231.416 529.412 230.176 529.17 229.087 528.688C227.998 528.195 227.136 527.471 226.501 526.514C225.876 525.548 225.564 524.346 225.564 522.906C225.564 521.694 225.786 520.676 226.232 519.852C226.677 519.028 227.283 518.366 228.05 517.864C228.817 517.362 229.688 516.983 230.663 516.727C231.648 516.472 232.68 516.292 233.76 516.188C235.029 516.055 236.052 515.932 236.828 515.818C237.605 515.695 238.168 515.515 238.518 515.278C238.869 515.042 239.044 514.691 239.044 514.227V514.142C239.044 513.242 238.76 512.546 238.192 512.054C237.633 511.562 236.838 511.315 235.805 511.315C234.716 511.315 233.85 511.557 233.206 512.04C232.562 512.513 232.136 513.11 231.928 513.83L226.331 513.375C226.615 512.049 227.174 510.903 228.007 509.938C228.84 508.962 229.915 508.214 231.232 507.693C232.557 507.163 234.091 506.898 235.834 506.898C237.046 506.898 238.206 507.04 239.314 507.324C240.431 507.608 241.421 508.048 242.283 508.645C243.154 509.241 243.84 510.009 244.342 510.946C244.844 511.874 245.095 512.987 245.095 514.284V529H239.357V525.974H239.186C238.836 526.656 238.367 527.258 237.78 527.778C237.193 528.29 236.487 528.692 235.663 528.986C234.839 529.27 233.888 529.412 232.808 529.412ZM234.541 525.236C235.431 525.236 236.217 525.061 236.899 524.71C237.581 524.35 238.116 523.867 238.504 523.261C238.893 522.655 239.087 521.969 239.087 521.202V518.886C238.897 519.009 238.637 519.123 238.305 519.227C237.983 519.322 237.619 519.412 237.212 519.497C236.804 519.573 236.397 519.644 235.99 519.71C235.583 519.767 235.214 519.819 234.882 519.866C234.172 519.971 233.552 520.136 233.021 520.364C232.491 520.591 232.079 520.899 231.786 521.287C231.492 521.666 231.345 522.139 231.345 522.707C231.345 523.531 231.643 524.161 232.24 524.597C232.846 525.023 233.613 525.236 234.541 525.236ZM261.395 507.182V511.727H248.256V507.182H261.395ZM251.239 501.955H257.29V522.295C257.29 522.854 257.375 523.29 257.545 523.602C257.716 523.905 257.953 524.118 258.256 524.241C258.568 524.365 258.928 524.426 259.335 524.426C259.619 524.426 259.903 524.402 260.188 524.355C260.472 524.298 260.689 524.256 260.841 524.227L261.793 528.73C261.49 528.825 261.063 528.934 260.514 529.057C259.965 529.189 259.297 529.27 258.511 529.298C257.053 529.355 255.775 529.161 254.676 528.716C253.587 528.271 252.74 527.58 252.134 526.642C251.527 525.705 251.229 524.521 251.239 523.091V501.955ZM275.045 529.426C272.801 529.426 270.869 528.972 269.25 528.062C267.64 527.144 266.4 525.847 265.528 524.17C264.657 522.485 264.222 520.491 264.222 518.19C264.222 515.946 264.657 513.976 265.528 512.281C266.4 510.586 267.626 509.265 269.207 508.318C270.798 507.371 272.664 506.898 274.804 506.898C276.243 506.898 277.583 507.13 278.824 507.594C280.074 508.048 281.163 508.735 282.091 509.653C283.028 510.572 283.758 511.727 284.278 513.119C284.799 514.502 285.06 516.121 285.06 517.977V519.639H266.636V515.889H279.364C279.364 515.018 279.174 514.246 278.795 513.574C278.417 512.902 277.891 512.376 277.219 511.997C276.556 511.609 275.784 511.415 274.903 511.415C273.985 511.415 273.17 511.628 272.46 512.054C271.759 512.471 271.21 513.034 270.812 513.744C270.415 514.445 270.211 515.226 270.202 516.088V519.653C270.202 520.733 270.401 521.666 270.798 522.452C271.205 523.238 271.778 523.844 272.517 524.27C273.256 524.696 274.132 524.909 275.145 524.909C275.817 524.909 276.433 524.814 276.991 524.625C277.55 524.436 278.028 524.152 278.426 523.773C278.824 523.394 279.127 522.93 279.335 522.381L284.932 522.75C284.648 524.095 284.065 525.269 283.185 526.273C282.313 527.267 281.187 528.044 279.804 528.602C278.431 529.152 276.845 529.426 275.045 529.426Z"
          fill="white"
        />
        <path
          d="M201.591 160C181.455 159.941 162.042 167.498 147.246 181.155C132.451 194.813 123.367 213.561 121.818 233.637H85L134.091 282.728L183.182 233.637H146.732C148.241 220.141 154.669 207.674 164.789 198.618C174.909 189.562 188.011 184.552 201.591 184.546C216.238 184.546 230.285 190.364 240.642 200.721C251 211.079 256.818 225.126 256.818 239.773C256.818 254.42 251 268.468 240.642 278.825C230.285 289.182 216.238 295 201.591 295H97.2727V319.546H201.591C222.748 319.546 243.038 311.141 257.999 296.181C272.959 281.221 281.364 260.93 281.364 239.773C281.364 218.616 272.959 198.326 257.999 183.365C243.038 168.405 222.748 160 201.591 160ZM305.909 258.182V295H275.227C267.74 304.977 258.304 313.328 247.491 319.546H305.909V356.364L355 307.273L305.909 258.182Z"
          fill="white"
        />
      </svg>

      <WorkerLine model={model} />
      {components}
    </>
  );
}

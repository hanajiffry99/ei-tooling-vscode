/**
 * Copyright (c) 2023, WSO2 LLC. (http://www.wso2.org) All Rights Reserved.
 *
 * WSO2 Inc. licenses this file to you under the Apache License,
 * Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations
 * under the License.
 *
 */

import React from "react";
import { Circle } from "@wso2-ei/low-code-diagram";
import { getComponent } from "../../util";
import { WorkerLine } from "../worker-line";

interface SquareProps {
  model: Circle;
}

export function Aggregate(props: SquareProps) {
  const { model } = props;

  const viewState = model.viewState;
  const components: JSX.Element[] = [];

  model.children.forEach((child) => {
    components.push(getComponent(child.type, { model: child }));
  });

  return (
    <>
      <svg
        x={viewState.bBox.x}
        y={viewState.bBox.y}
        width={viewState.bBox.w}
        height={viewState.bBox.h}
        viewBox="0 0 800 600"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <rect width="800" height="600" fill="#C0C0C0" />
        <path d="M10 10H430V590H10V10Z" fill="#AD7B41" />
        <rect x="480" y="10" width="310" height="580" fill="#A9A9A9" />
        <path d="M468 299.5L439.5 335.44V263.56L468 299.5Z" fill="#71797E" />
        <path
          d="M127.605 529H121.98L132.222 499.909H138.727L148.983 529H143.358L135.588 505.875H135.361L127.605 529ZM127.79 517.594H143.131V521.827H127.79V517.594ZM161.412 537.636C159.565 537.636 157.979 537.385 156.653 536.884C155.328 536.391 154.262 535.728 153.457 534.895C152.652 534.062 152.094 533.138 151.781 532.125L156.412 531.003C156.62 531.429 156.923 531.85 157.321 532.267C157.719 532.693 158.254 533.044 158.926 533.318C159.608 533.602 160.465 533.744 161.497 533.744C162.955 533.744 164.163 533.389 165.119 532.679C166.076 531.978 166.554 530.823 166.554 529.213V525.08H166.298C166.033 525.61 165.645 526.154 165.134 526.713C164.632 527.272 163.964 527.741 163.131 528.119C162.307 528.498 161.27 528.688 160.02 528.688C158.344 528.688 156.824 528.295 155.46 527.509C154.106 526.713 153.027 525.529 152.222 523.957C151.426 522.376 151.028 520.397 151.028 518.02C151.028 515.624 151.426 513.602 152.222 511.955C153.027 510.297 154.111 509.043 155.474 508.19C156.838 507.329 158.358 506.898 160.034 506.898C161.313 506.898 162.364 507.116 163.188 507.551C164.021 507.977 164.684 508.493 165.176 509.099C165.669 509.696 166.043 510.259 166.298 510.79H166.582V507.182H171.653V529.355C171.653 531.221 171.208 532.764 170.318 533.986C169.428 535.207 168.211 536.121 166.668 536.727C165.124 537.333 163.372 537.636 161.412 537.636ZM161.455 524.653C162.544 524.653 163.472 524.388 164.239 523.858C165.006 523.328 165.588 522.565 165.986 521.571C166.384 520.577 166.582 519.384 166.582 517.991C166.582 516.618 166.384 515.416 165.986 514.384C165.598 513.351 165.02 512.551 164.253 511.983C163.495 511.405 162.563 511.116 161.455 511.116C160.309 511.116 159.352 511.415 158.585 512.011C157.818 512.608 157.241 513.427 156.852 514.469C156.464 515.501 156.27 516.675 156.27 517.991C156.27 519.327 156.464 520.496 156.852 521.5C157.25 522.494 157.832 523.271 158.599 523.83C159.376 524.379 160.328 524.653 161.455 524.653ZM186.412 537.636C184.565 537.636 182.979 537.385 181.653 536.884C180.328 536.391 179.262 535.728 178.457 534.895C177.652 534.062 177.094 533.138 176.781 532.125L181.412 531.003C181.62 531.429 181.923 531.85 182.321 532.267C182.719 532.693 183.254 533.044 183.926 533.318C184.608 533.602 185.465 533.744 186.497 533.744C187.955 533.744 189.163 533.389 190.119 532.679C191.076 531.978 191.554 530.823 191.554 529.213V525.08H191.298C191.033 525.61 190.645 526.154 190.134 526.713C189.632 527.272 188.964 527.741 188.131 528.119C187.307 528.498 186.27 528.688 185.02 528.688C183.344 528.688 181.824 528.295 180.46 527.509C179.106 526.713 178.027 525.529 177.222 523.957C176.426 522.376 176.028 520.397 176.028 518.02C176.028 515.624 176.426 513.602 177.222 511.955C178.027 510.297 179.111 509.043 180.474 508.19C181.838 507.329 183.358 506.898 185.034 506.898C186.313 506.898 187.364 507.116 188.188 507.551C189.021 507.977 189.684 508.493 190.176 509.099C190.669 509.696 191.043 510.259 191.298 510.79H191.582V507.182H196.653V529.355C196.653 531.221 196.208 532.764 195.318 533.986C194.428 535.207 193.211 536.121 191.668 536.727C190.124 537.333 188.372 537.636 186.412 537.636ZM186.455 524.653C187.544 524.653 188.472 524.388 189.239 523.858C190.006 523.328 190.588 522.565 190.986 521.571C191.384 520.577 191.582 519.384 191.582 517.991C191.582 516.618 191.384 515.416 190.986 514.384C190.598 513.351 190.02 512.551 189.253 511.983C188.495 511.405 187.563 511.116 186.455 511.116C185.309 511.116 184.352 511.415 183.585 512.011C182.818 512.608 182.241 513.427 181.852 514.469C181.464 515.501 181.27 516.675 181.27 517.991C181.27 519.327 181.464 520.496 181.852 521.5C182.25 522.494 182.832 523.271 183.599 523.83C184.376 524.379 185.328 524.653 186.455 524.653ZM201.923 529V507.182H206.909V510.818H207.136C207.534 509.559 208.216 508.588 209.182 507.906C210.157 507.215 211.27 506.869 212.52 506.869C212.804 506.869 213.121 506.884 213.472 506.912C213.831 506.931 214.13 506.964 214.366 507.011V511.741C214.149 511.666 213.803 511.599 213.33 511.543C212.866 511.476 212.416 511.443 211.98 511.443C211.043 511.443 210.2 511.647 209.452 512.054C208.713 512.452 208.131 513.006 207.705 513.716C207.278 514.426 207.065 515.245 207.065 516.173V529H201.923ZM226.543 529.426C224.356 529.426 222.467 528.972 220.876 528.062C219.294 527.144 218.077 525.847 217.225 524.17C216.373 522.485 215.947 520.501 215.947 518.219C215.947 515.974 216.373 514.005 217.225 512.31C218.087 510.605 219.29 509.279 220.833 508.332C222.377 507.376 224.19 506.898 226.273 506.898C227.618 506.898 228.887 507.116 230.08 507.551C231.283 507.977 232.344 508.64 233.262 509.54C234.19 510.439 234.919 511.585 235.45 512.977C235.98 514.36 236.245 516.008 236.245 517.92V519.497H218.362V516.031H231.316C231.307 515.046 231.094 514.17 230.677 513.403C230.26 512.627 229.678 512.016 228.93 511.571C228.191 511.126 227.329 510.903 226.344 510.903C225.293 510.903 224.37 511.159 223.575 511.67C222.779 512.172 222.159 512.835 221.714 513.659C221.278 514.473 221.056 515.368 221.046 516.344V519.369C221.046 520.638 221.278 521.727 221.742 522.636C222.206 523.536 222.855 524.227 223.688 524.71C224.522 525.184 225.497 525.42 226.614 525.42C227.362 525.42 228.04 525.316 228.646 525.108C229.252 524.89 229.777 524.573 230.222 524.156C230.667 523.74 231.004 523.223 231.231 522.608L236.032 523.148C235.729 524.417 235.151 525.525 234.299 526.472C233.456 527.409 232.377 528.138 231.06 528.659C229.744 529.17 228.238 529.426 226.543 529.426ZM250.084 537.636C248.237 537.636 246.651 537.385 245.325 536.884C244 536.391 242.934 535.728 242.129 534.895C241.324 534.062 240.766 533.138 240.453 532.125L245.084 531.003C245.292 531.429 245.595 531.85 245.993 532.267C246.391 532.693 246.926 533.044 247.598 533.318C248.28 533.602 249.137 533.744 250.169 533.744C251.627 533.744 252.835 533.389 253.791 532.679C254.748 531.978 255.226 530.823 255.226 529.213V525.08H254.97C254.705 525.61 254.317 526.154 253.805 526.713C253.304 527.272 252.636 527.741 251.803 528.119C250.979 528.498 249.942 528.688 248.692 528.688C247.016 528.688 245.496 528.295 244.132 527.509C242.778 526.713 241.698 525.529 240.893 523.957C240.098 522.376 239.7 520.397 239.7 518.02C239.7 515.624 240.098 513.602 240.893 511.955C241.698 510.297 242.783 509.043 244.146 508.19C245.51 507.329 247.03 506.898 248.706 506.898C249.984 506.898 251.036 507.116 251.859 507.551C252.693 507.977 253.356 508.493 253.848 509.099C254.34 509.696 254.714 510.259 254.97 510.79H255.254V507.182H260.325V529.355C260.325 531.221 259.88 532.764 258.99 533.986C258.1 535.207 256.883 536.121 255.339 536.727C253.796 537.333 252.044 537.636 250.084 537.636ZM250.126 524.653C251.215 524.653 252.143 524.388 252.911 523.858C253.678 523.328 254.26 522.565 254.658 521.571C255.055 520.577 255.254 519.384 255.254 517.991C255.254 516.618 255.055 515.416 254.658 514.384C254.269 513.351 253.692 512.551 252.925 511.983C252.167 511.405 251.234 511.116 250.126 511.116C248.981 511.116 248.024 511.415 247.257 512.011C246.49 512.608 245.912 513.427 245.524 514.469C245.136 515.501 244.942 516.675 244.942 517.991C244.942 519.327 245.136 520.496 245.524 521.5C245.922 522.494 246.504 523.271 247.271 523.83C248.048 524.379 249 524.653 250.126 524.653ZM271.874 529.44C270.491 529.44 269.246 529.194 268.138 528.702C267.039 528.2 266.168 527.461 265.524 526.486C264.89 525.51 264.572 524.308 264.572 522.878C264.572 521.647 264.8 520.629 265.254 519.824C265.709 519.019 266.329 518.375 267.115 517.892C267.901 517.409 268.786 517.045 269.771 516.798C270.766 516.543 271.793 516.358 272.854 516.244C274.132 516.112 275.169 515.993 275.964 515.889C276.76 515.776 277.338 515.605 277.697 515.378C278.067 515.141 278.251 514.777 278.251 514.284V514.199C278.251 513.129 277.934 512.3 277.3 511.713C276.665 511.126 275.751 510.832 274.558 510.832C273.299 510.832 272.3 511.107 271.561 511.656C270.832 512.205 270.339 512.854 270.084 513.602L265.283 512.92C265.661 511.595 266.286 510.487 267.158 509.597C268.029 508.697 269.094 508.025 270.354 507.58C271.613 507.125 273.005 506.898 274.53 506.898C275.581 506.898 276.627 507.021 277.669 507.267C278.711 507.513 279.662 507.92 280.524 508.489C281.386 509.047 282.077 509.81 282.598 510.776C283.128 511.741 283.393 512.949 283.393 514.398V529H278.45V526.003H278.28C277.967 526.609 277.527 527.177 276.959 527.707C276.4 528.228 275.695 528.65 274.842 528.972C274 529.284 273.01 529.44 271.874 529.44ZM273.209 525.662C274.241 525.662 275.136 525.458 275.893 525.051C276.651 524.634 277.233 524.085 277.641 523.403C278.057 522.722 278.266 521.978 278.266 521.173V518.602C278.105 518.735 277.83 518.858 277.442 518.972C277.063 519.085 276.637 519.185 276.163 519.27C275.69 519.355 275.221 519.431 274.757 519.497C274.293 519.563 273.891 519.62 273.55 519.668C272.783 519.772 272.096 519.942 271.49 520.179C270.884 520.416 270.406 520.747 270.055 521.173C269.705 521.59 269.53 522.13 269.53 522.793C269.53 523.74 269.875 524.455 270.567 524.938C271.258 525.42 272.139 525.662 273.209 525.662ZM299.459 507.182V511.159H286.916V507.182H299.459ZM290.013 501.955H295.155V522.438C295.155 523.129 295.259 523.659 295.467 524.028C295.685 524.388 295.969 524.634 296.32 524.767C296.67 524.9 297.058 524.966 297.484 524.966C297.806 524.966 298.1 524.942 298.365 524.895C298.64 524.848 298.848 524.805 298.99 524.767L299.857 528.787C299.582 528.882 299.189 528.986 298.678 529.099C298.176 529.213 297.56 529.279 296.831 529.298C295.543 529.336 294.383 529.142 293.351 528.716C292.319 528.28 291.5 527.608 290.893 526.699C290.297 525.79 290.003 524.653 290.013 523.29V501.955ZM313.184 529.426C310.996 529.426 309.107 528.972 307.516 528.062C305.935 527.144 304.718 525.847 303.866 524.17C303.013 522.485 302.587 520.501 302.587 518.219C302.587 515.974 303.013 514.005 303.866 512.31C304.728 510.605 305.93 509.279 307.474 508.332C309.017 507.376 310.831 506.898 312.914 506.898C314.259 506.898 315.528 507.116 316.721 507.551C317.924 507.977 318.984 508.64 319.903 509.54C320.831 510.439 321.56 511.585 322.09 512.977C322.621 514.36 322.886 516.008 322.886 517.92V519.497H305.002V516.031H317.957C317.947 515.046 317.734 514.17 317.317 513.403C316.901 512.627 316.318 512.016 315.57 511.571C314.832 511.126 313.97 510.903 312.985 510.903C311.934 510.903 311.011 511.159 310.215 511.67C309.42 512.172 308.799 512.835 308.354 513.659C307.919 514.473 307.696 515.368 307.687 516.344V519.369C307.687 520.638 307.919 521.727 308.383 522.636C308.847 523.536 309.496 524.227 310.329 524.71C311.162 525.184 312.138 525.42 313.255 525.42C314.003 525.42 314.68 525.316 315.286 525.108C315.892 524.89 316.418 524.573 316.863 524.156C317.308 523.74 317.644 523.223 317.871 522.608L322.673 523.148C322.37 524.417 321.792 525.525 320.94 526.472C320.097 527.409 319.017 528.138 317.701 528.659C316.385 529.17 314.879 529.426 313.184 529.426Z"
          fill="white"
        />
        <path
          d="M347 274.5L295 308.956V283.114H193.34L122.75 364L100 355.386L170.72 274.5L100 193.614L122.75 185L193.34 265.886H295V240.044L347 274.5Z"
          fill="white"
        />
      </svg>

      <WorkerLine model={model} />
      {components}
    </>
  );
}
